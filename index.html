<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>İngiliz Kültür Koleji - Yeni Kayıt</title>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800&display=swap" rel="stylesheet">
<style>
    :root {
        --primary: #d90429; /* İngiliz Kültür Kırmızısı */
        --secondary: #2b2d42; /* Koyu Lacivert */
        --bg: #edf2f4;
    }
    body {
        font-family: 'Outfit', sans-serif;
        background-color: var(--bg);
        margin: 0;
        padding: 20px;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
    }
    .container {
        background: white;
        padding: 40px;
        border-radius: 20px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        width: 100%;
        max-width: 500px;
        position: relative;
        overflow: hidden;
    }
    .logo-area {
        text-align: center;
        margin-bottom: 20px;
    }
    /* Logo Ayarları */
    .logo-area img {
        max-width: 200px; /* Logo boyutunu buradan ayarlayabilirsin */
        height: auto;
        display: block;
        margin: 0 auto;
    }
    
    h2 { 
        text-align: center; 
        color: var(--secondary); 
        margin-bottom: 10px; 
        font-weight: 800; 
        font-size: 1.8rem; 
        line-height: 1.2; 
    }

    /* ÖNEMLİ NOT ALANI */
    .note-text {
        text-align: center;
        color: #ef4444;
        font-size: 0.95rem;
        font-weight: 600;
        margin-top: 0;
        margin-bottom: 30px;
        background-color: #fef2f2;
        padding: 10px;
        border-radius: 8px;
        border: 1px solid #fee2e2;
    }

    .form-group { margin-bottom: 20px; }
    label { display: block; margin-bottom: 8px; font-weight: 600; color: var(--secondary); font-size: 0.9rem; }
    input, select { width: 100%; padding: 14px; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 16px; box-sizing: border-box; transition: 0.3s; font-family: 'Outfit', sans-serif; }
    input:focus, select:focus { border-color: var(--primary); outline: none; box-shadow: 0 0 0 3px rgba(217, 4, 41, 0.1); }
    
    /* GÖRÜŞME ODALARI */
    .rooms-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
    .room-card {
        border: 2px solid #e2e8f0;
        border-radius: 12px;
        padding: 15px;
        text-align: center;
        cursor: pointer;
        transition: 0.3s;
        background: white;
    }
    .room-card h4 { margin: 0 0 5px; font-size: 1rem; color: var(--secondary); }
    .room-card p { margin: 0; font-size: 0.8rem; color: #64748b; }
    .room-card:hover { border-color: var(--primary); color: var(--primary); }
    .room-card.selected { border-color: var(--secondary); background-color: var(--secondary); color: white; }
    .room-card.selected h4, .room-card.selected p { color: white; }

    /* DOLU ODA STİLİ */
    .room-full {
        background-color: #f1f5f9; 
        color: #94a3b8; 
        border-color: #e2e8f0;
        cursor: not-allowed; 
        pointer-events: none; 
        opacity: 0.7;
    }
    .room-full h4, .room-full p { color: #94a3b8; }

    button.submit-btn {
        width: 100%;
        padding: 16px;
        background-color: var(--primary);
        color: white;
        border: none;
        border-radius: 12px;
        font-size: 1.1rem;
        font-weight: 800;
        cursor: pointer;
        transition: 0.3s;
        margin-top: 10px;
    }
    button.submit-btn:hover { background-color: #b90324; transform: translateY(-2px); }
    
    .captcha-group { display: flex; gap: 10px; }
    .captcha-display { 
        background: #e2e8f0; 
        padding: 10px; 
        border-radius: 8px; 
        font-weight: 800; 
        letter-spacing: 5px; 
        text-align: center;
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        color: var(--secondary);
        user-select: none;
    }

    .success {
        background-color: #d1fae5;
        color: #065f46;
        padding: 15px;
        border-radius: 10px;
        text-align: center;
        margin-top: 20px;
        font-weight: 600;
    }
    
    @media (max-width: 480px) {
        .container { padding: 25px; }
        h2 { font-size: 1.5rem; }
    }
</style>
</head>
<body>

<div class="container">
    <div class="logo-area">
        <img src="https://upload.wikimedia.org/wikipedia/tr/b/b3/%C4%B0ngiliz_K%C3%3Clt%C3%BCr_Derne%C4%9Fi_Dil_Okullar%C4%B1_logosu.png" alt="İngiliz Kültür Koleji Logo">
    </div>

    <h2>Yeni Kayıt Randevusu</h2>
    
    <div class="note-text">
        ⚠️ Bu alandan sadece kurumumuz öğrencisi olmayan veliler randevu alabilir.
    </div>

    <form id="appointmentForm">
        <div class="form-group">
            <label>Veli Adı Soyadı</label>
            <input type="text" id="parentName" placeholder="Örn: Ahmet Yılmaz" required>
        </div>

        <div class="form-group">
            <label>Telefon Numarası</label>
            <input type="tel" id="phone" placeholder="05XX XXX XX XX" required>
        </div>
        
        <div class="form-group">
            <label>Öğrenci Adı Soyadı</label>
            <input type="text" id="studentName" placeholder="Örn: Can Yılmaz" required>
        </div>

        <div class="form-group">
            <label>Öğrenci Sınıf Seviyesi (Seneye Okuyacağı)</label>
            <select id="grade" required>
                <option value="">Seçiniz</option>
                <option value="Anaokulu">Anaokulu</option>
                <option value="1">1. Sınıf</option>
                <option value="2">2. Sınıf</option>
                <option value="3">3. Sınıf</option>
                <option value="4">4. Sınıf</option>
                <option value="5">5. Sınıf</option>
                <option value="6">6. Sınıf</option>
                <option value="7">7. Sınıf</option>
                <option value="8">8. Sınıf</option>
            </select>
        </div>

        <div class="form-group">
            <label>Randevu Tarihi</label>
            <input type="date" id="appointmentDate" required>
        </div>

        <div class="form-group">
            <label>Görüşme Odası Seçimi</label>
            <div class="rooms-grid">
                <div class="room-card room-full" id="room-oxford" onclick="selectRoom('oxford')">
                    <h4>Oxford</h4>
                    <p>Görüşme Odası 1</p>
                </div>
                <div class="room-card room-full" id="room-manchester">
                    <h4>Manchester</h4>
                    <p>Görüşme Odası 2 (Dolu)</p>
                </div>
                <div class="room-card room-full" id="room-liverpool">
                    <h4>Liverpool</h4>
                    <p>Görüşme Odası 3 (Dolu)</p>
                </div>
                <div class="room-card room-full" id="room-cambridge">
                    <h4>Cambridge</h4>
                    <p>Görüşme Odası 4 (Dolu)</p>
                </div>
            </div>
            <input type="hidden" id="selectedRoom" required>
        </div>

        <div class="form-group">
            <label>Randevu Saati</label>
            <select id="appointmentTime" required disabled>
                <option value="">Önce Tarih Seçiniz</option>
            </select>
        </div>

        <div class="form-group">
            <label>Güvenlik Doğrulaması</label>
            <div class="captcha-group">
                <div class="captcha-display" id="captchaDisplay"></div>
                <input type="text" id="captchaInput" placeholder="Kodu giriniz" required style="width: 50%;">
            </div>
        </div>

        <button type="submit" class="submit-btn">Randevu Oluştur</button>
        <div id="message"></div>
    </form>
</div>

<script>
    // --- DOLULUK SİMÜLASYONU (TEMİZLENDİ) ---
    // Artık tüm saatler boş gözükecek
    const takenSlots = {};

    let captchaCode = '';

    function generateCaptcha() {
        const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';
        captchaCode = '';
        for (let i = 0; i < 5; i++) {
            captchaCode += chars.charAt(Math.floor(Math.random() * chars.length));
        }
        document.getElementById('captchaDisplay').innerText = captchaCode;
    }

    // Sayfa Yüklendiğinde
    window.onload = function() {
        generateCaptcha();
        
        // --- TARİH KISITLAMASI (BUGÜN VE SONRASI) ---
        // Yerel saati doğru alması için güncellendi
        const date = new Date();
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        const todayStr = `${year}-${month}-${day}`;
        
        document.getElementById('appointmentDate').setAttribute('min', todayStr);
    };

    // --- ODA SEÇİMİ ---
    function selectRoom(roomName) {
        const roomEl = document.getElementById('room-' + roomName);
        if (roomEl.classList.contains('room-full')) return; // Doluysa seçilemez

        // Diğer seçimleri kaldır
        document.querySelectorAll('.room-card').forEach(c => c.classList.remove('selected'));
        // Yenisini seç
        roomEl.classList.add('selected');
        document.getElementById('selectedRoom').value = roomName;
    }

    // --- TARİH DEĞİŞİNCE ---
    document.getElementById('appointmentDate').addEventListener('change', function() {
        const selectedDate = new Date(this.value);
        const dayOfWeek = selectedDate.getDay(); // 0 = Pazar
        const dateString = this.value;

        // Oda Mantığı: Sadece Oxford açılır (Tarih seçilince)
        const rOx = document.getElementById('room-oxford');
        
        // Önce resetle
        document.querySelectorAll('.room-card').forEach(c => {
            c.classList.remove('selected');
            c.classList.add('room-full'); // Hepsini kapat
        });
        document.getElementById('selectedRoom').value = '';

        // Oxford'u Aç
        if (dayOfWeek !== 0) { // Pazar değilse aç
            rOx.classList.remove('room-full');
        }

        // Saati Aktif Et
        const timeSelect = document.getElementById('appointmentTime');
        timeSelect.disabled = false;
        timeSelect.innerHTML = '<option value="">Saat Seçiniz</option>';

        // --- YENİ SAAT MANTIĞI ---
        if (dayOfWeek === 0) {
            // Pazar Günü
            const opt = document.createElement('option');
            opt.text = "Pazar günü kurumumuz kapalıdır.";
            opt.disabled = true;
            timeSelect.add(opt);
            timeSelect.disabled = true; // Seçimi tekrar kapat
        } else {
            // Hafta İçi ve Cumartesi Sabit Saatler
            const availableHours = ["09:30", "10:30", "11:30", "13:30", "14:30", "15:30", "16:30"];

            availableHours.forEach(time => {
                const option = document.createElement('option');
                option.value = time;
                
                // Doluluk Kontrolü (Artık takenSlots boş olduğu için hepsi boş gelecek)
                let isFull = false;
                if (takenSlots[dateString] && takenSlots[dateString].includes(time)) {
                    isFull = true;
                }

                if (isFull) {
                    option.textContent = `${time} (Dolu)`;
                    option.disabled = true;
                    option.style.color = '#ccc';
                } else {
                    option.textContent = time;
                }

                timeSelect.appendChild(option);
            });
        }
    });

    // --- FORM GÖNDERME ---
    document.getElementById('appointmentForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const userCaptcha = document.getElementById('captchaInput').value.toUpperCase();
        const room = document.getElementById('selectedRoom').value;

        if (userCaptcha !== captchaCode) {
            alert('Güvenlik kodu hatalı! Lütfen tekrar deneyiniz.');
            generateCaptcha();
            return;
        }

        if (!room) {
            alert('Lütfen bir görüşme odası seçiniz (Oxford).');
            return;
        }

        const msg = document.getElementById('message');
        msg.innerText = '✅ Randevunuz başarıyla oluşturuldu! Sizi arayacağız.';
        msg.className = 'success';
        
        // Formu temizle
        this.reset();
        
        // Odayı ve saati tekrar kilitle
        document.querySelectorAll('.room-card').forEach(c => {
            c.classList.remove('selected');
            c.classList.add('room-full');
        });
        document.getElementById('appointmentTime').innerHTML = '<option value="">Önce Tarih Seçiniz</option>';
        document.getElementById('appointmentTime').disabled = true;
        
        generateCaptcha();
    });
</script>

</body>
</html>
